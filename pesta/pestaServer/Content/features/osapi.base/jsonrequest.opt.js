var osapi=osapi||{};(function(){var s={};function m(u){s=u["osapi.base"]}var i={rpcUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("osapi.base",i,m);var f="application/json";var j="JSON";var c=function(u){return{CONTENT_TYPE:j,METHOD:"POST",AUTHORIZATION:"SIGNED",POST_DATA:gadgets.json.stringify(u)}};var b=function(){if(s.rpcUrl){var w=s.rpcUrl.replace("%host%",document.location.host)}var u=[w,"/rpc"];var v=shindig.auth.getSecurityToken();if(v){u.push("?st=",encodeURIComponent(v))}return u.join("")};var l=function(u){var v=osapi.base.translateHttpError(u.errors[0]||u.data.error)||"internalError";var w={};osapi.base.setGlobalError(w,{code:v});return w};var r=function(v,u){return function(w){if(w.errors[0]){u(l(w))}else{u(v(w))}}};var n="@viewer";var a="@self";var d=20;var q=function(u){var v=u.data;if(v[0].error){return{error:{code:osapi.base.translateHttpError("Error "+v[0].error.code),message:v[0].error.message}}}else{if(v[0].data.list){return v[0].data.list}else{return v[0].data}}};var k=function(x,w,v,u){if(x[w]){x[v]=x[w];delete x[w]}else{if(u){x[v]=u}}};var o=function(u){if(u.userId){u.userId=(u.userId.constructor===Array)?u.userId:[u.userId]}else{u.userId=[n]}};var t=function(u){u.groupId=u.groupId||a};var h=function(w,u){o(u);t(u);var v={method:w};v.params=u;return[v]};var g=function(u,v){return function(w){w=w||function(){};var x=u();if(x.length==0){window.setTimeout(function(){r(v,w)({errors:[]})},0)}else{gadgets.io.makeNonProxiedRequest(b(),r(v,w),c(x),f)}}};var p=function(u,w){w=w||{};var v=function(){return h(u,w)};var x=g(v,q);return{json:v,execute:x}};var e=function(u,v){var w=g(u,v);return{execute:w}};osapi.newJsonRequest=p;osapi.newBatchJsonRequest=e})();